# Log Parsing with Self-Generated In-Context Learning and Self-Correction


This paper introduces introduces AdaParser, an adaptive log parsing framework leveraging large language models (LLMs). It addresses the limitations of existing log parsers by utilizing self-generated in-context learning (SG-ICL) and a self-correction mechanism to enhance accuracy and adaptability to evolving log data.

Key contributions include:
1. A tree-based parser for efficiency.
2. SG-ICL, which maintains a dynamic candidate set to guide the LLM in parsing evolving log data.
3. A template corrector that refines LLM-generated templates to reduce parsing errors.

Extensive experiments on large-scale datasets demonstrate AdaParser's superior performance and robustness compared to state-of-the-art methods, even in zero-shot scenarios. The framework also proves generalizable across various LLMs, significantly improving their log parsing capabilities.

## Problem
This paper identifies two major problems in log parsing, especially using large language models (LLMs):

1. **Inaccuracies in Log Parsing:**
   - LLMs have strong text understanding and generation capabilities, but often produce inaccurate parsing templates. This problem occurs in two forms:
     - Plausible Template: The generated template does not fully match the input log message, for example breaking important information into incorrect variables.
     - Broad Template: The template includes information that should be an important part of the log as variables, thus reducing accuracy for further analysis such as troubleshooting.

2. **Inability to Adapt to Growing Logs:**
  Many LLM-based parsers rely on historical log data to select candidates for demonstration. However, due to frequent software updates, logs grow, making sufficient historical data unavailable. In extreme cases, such as launching a new service, no historical log data is available, resulting in a significant decrease in parsing accuracy.


## Contribution of the Paper
This paper makes several major contributions to the field of LLM-based log parsing, including:
1. **Introduction to AdaParser:** AdaParser is an adaptive log parsing framework that leverages self-generated in-context learning (SG-ICL) and self-correction mechanisms. The framework is designed to address the accuracy and adaptability issues in log parsing.
2. **Penggunaan SG-ICL:** Framework ini menggunakan SG-ICL untuk membuat set kandidat dinamis dari template yang dihasilkan sebelumnya oleh LLM. Set ini digunakan untuk membangun prompt yang memandu LLM dalam memproses log baru, memungkinkan adaptasi yang lebih baik terhadap data log yang berkembang.
3. **Implementation of Template Corrector:** AdaParser includes an innovative template corrector component, which uses LLM to correct errors in generated templates. This improves parsing accuracy by correcting template errors, such as overly broad or inappropriate templates.

## System Architecture
**1. Tree-Based Parser:**
Uses a trie-based tree structure to store log templates previously generated by the LLM. When a new log is received, this parser matches it with existing templates in the tree. If a match is found, the template is used directly without calling the LLM again, improving efficiency.

**2. SG-ICL-Based Parser:**
This parser employs a dynamic candidate set composed of templates previously generated by the LLM. SG-ICL uses these templates as demonstrations to construct prompts that assist the LLM in parsing new logs, adapting to the continuously evolving characteristics of the logs.

**3. Template Corrector:**
This component is responsible for correcting templates generated by the LLM. Using a self-correction strategy, the template corrector ensures that the generated templates align with the input logs, avoiding parsing errors such as overly broad or inaccurate templates.

## Basic Concept
**1. Self-Generated In-Context Learning (SG-ICL):**
SG-ICL is a mechanism where the LLM utilizes previously generated templates as demonstrations to guide the parsing of new logs. This dynamic candidate set is updated based on the generated logs and templates, enabling adaptation to evolving log data without the need for retraining the model.

**2. Self-Correction:**
This method employs self-correction to fix errors in the generated templates. There are two main correction strategies:
   - Template Matching Correction: Ensures that the generated template matches the input log.
   - Variable Abstracting Correction: Ensures that important parts of the log (such as exception information) are not incorrectly abstracted into variables.

**3. Dynamic Candidate Set:**
This dynamic candidate set helps SG-ICL select relevant demonstrations for log parsing, enhancing the LLM's ability to adapt to continuously changing logs.

## Performance Metrics
**- Grouping Accuracy (GA):**
Measures the system's ability to group logs that share the same template. GA is calculated as the ratio of correctly grouped logs to the total number of logs.

**- F1 Score of Grouping Accuracy (FGA):**
FGA is a template-based metric that measures the proportion of correctly grouped templates. It is calculated as the harmonic mean of precision and recall at the template level.

**- Parsing Accuracy (PA):**
This metric measures the system's ability to extract static templates and dynamic variables from each log message. PA is calculated as the ratio of correctly parsed log messages to the total number of log messages.

**- F1 Score of Template Accuracy (FTA):**
Similar to FGA, FTA focuses on the template level, measuring the proportion of correctly identified templates. FTA is the harmonic mean of precision and recall at the template level.

## Paper Result to ensure the goal is achieved
The paper ensures that the goal is achieved by conducting extensive experiments using a large-scale log dataset. They compare AdaParser with state-of-the-art methods using performance metrics such as Grouping Accuracy (GA), Parsing Accuracy (PA), and F1 Score. The results show that AdaParser excels in accuracy and efficiency, even in zero-shot scenarios, confirming that the framework is capable of adapting and providing accurate parsing results on evolving logs.

## Reference
https://arxiv.org/pdf/2406.03376
